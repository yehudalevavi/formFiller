<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#667eea">
    <title>טופס ביקור רגיל - מילוי טופס PDF</title>
    <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>טופס ביקור רגיל</h1>
            <p class="subtitle">מילוי טופס ביקור בית - לאחר השמה/שוטף</p>
        </header>

        <!-- PDF Upload Section -->
        <section class="form-section upload-section">
            <h2>העלאת קובץ PDF</h2>
            <p class="upload-instructions">
                העלה קובץ PDF עם פרטי המעסיק והעובד הזר מולאים מראש.
                הקובץ חייב להיות בפורמט זהה לטופס הביקור הרגיל (4 עמודים).
            </p>
            <div class="form-group">
                <label for="pdfUpload">בחר קובץ PDF</label>
                <div class="file-upload-wrapper">
                    <input type="file" id="pdfUpload" accept=".pdf" class="file-input">
                    <div class="file-upload-display">
                        <span class="file-name" id="fileName">לא נבחר קובץ</span>
                        <button type="button" class="btn-browse" id="browseBtn">בחר קובץ</button>
                    </div>
                </div>
            </div>
            <div id="uploadStatus" class="upload-status" style="display: none;">
                <div class="status-icon"></div>
                <span class="status-message"></span>
            </div>
            <div id="uploadError" class="upload-error" style="display: none;"></div>
        </section>

        <form id="pdfForm" autocomplete="off">
            <!-- Page 1: Personal Details and Visit Info -->
            <section class="form-section">
                <h2>תאריך הביקור</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label for="visit_date">תאריך הביקור</label>
                        <input type="date" id="visit_date" name="visit_date" class="date-input">
                    </div>
                </div>
            </section>

            <!-- Page 1: Employer Personal Details -->
            <section class="form-section">
                <h2>פרטים אישיים של המעסיק</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label for="employer_last_name">שם משפחה</label>
                        <input type="text" id="employer_last_name" name="employer_last_name" maxlength="20">
                    </div>
                    <div class="form-group">
                        <label for="employer_first_name">שם פרטי</label>
                        <input type="text" id="employer_first_name" name="employer_first_name" maxlength="20">
                    </div>
                    <div class="form-group">
                        <label for="employer_id">מספר זהות</label>
                        <input type="text" id="employer_id" name="employer_id" maxlength="9">
                    </div>
                </div>

                <h3>כתובת המעסיק</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="employer_street">רחוב</label>
                        <input type="text" id="employer_street" name="employer_street" maxlength="30">
                    </div>
                    <div class="form-group">
                        <label for="employer_house_number">מספר בית</label>
                        <input type="text" id="employer_house_number" name="employer_house_number" maxlength="5" class="small-input">
                    </div>
                    <div class="form-group">
                        <label for="employer_entrance">כניסה</label>
                        <input type="text" id="employer_entrance" name="employer_entrance" maxlength="3" class="small-input">
                    </div>
                    <div class="form-group">
                        <label for="employer_apartment">דירה</label>
                        <input type="text" id="employer_apartment" name="employer_apartment" maxlength="5" class="small-input">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="employer_city">ישוב</label>
                        <input type="text" id="employer_city" name="employer_city" maxlength="20">
                    </div>
                    <div class="form-group">
                        <label for="employer_zipcode">מיקוד</label>
                        <input type="text" id="employer_zipcode" name="employer_zipcode" maxlength="7" class="small-input">
                    </div>
                </div>

                <h3>פרטי התקשרות</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="employer_landline">טלפון קווי</label>
                        <input type="text" id="employer_landline" name="employer_landline" maxlength="12">
                    </div>
                    <div class="form-group">
                        <label for="employer_mobile">טלפון נייד</label>
                        <input type="text" id="employer_mobile" name="employer_mobile" maxlength="12">
                    </div>
                    <div class="form-group wide">
                        <label for="employer_email">דואר אלקטרוני</label>
                        <input type="email" id="employer_email" name="employer_email" maxlength="40">
                    </div>
                </div>
            </section>

            <!-- Page 1: Worker Details -->
            <section class="form-section">
                <h2>פרטי העובד הזר</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label for="worker_passport">מספר דרכון</label>
                        <input type="text" id="worker_passport" name="worker_passport" maxlength="15">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="worker_last_name">שם משפחה</label>
                        <input type="text" id="worker_last_name" name="worker_last_name" maxlength="20">
                    </div>
                    <div class="form-group">
                        <label for="worker_first_name">שם פרטי</label>
                        <input type="text" id="worker_first_name" name="worker_first_name" maxlength="20">
                    </div>
                    <div class="form-group">
                        <label for="worker_origin_country">ארץ מוצא</label>
                        <input type="text" id="worker_origin_country" name="worker_origin_country" maxlength="15">
                    </div>
                    <div class="form-group">
                        <label for="worker_mobile">טלפון נייד</label>
                        <input type="text" id="worker_mobile" name="worker_mobile" maxlength="12">
                    </div>
                </div>

                <h3>פרטי השמה</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="placement_start_date">תאריך תחילת השמה</label>
                        <input type="date" id="placement_start_date" name="placement_start_date" class="date-input">
                    </div>
                    <div class="form-group">
                        <label>לשכה מייבאת</label>
                        <div class="checkbox-group inline">
                            <label><input type="checkbox" name="placement_israel"> ישראל</label>
                            <label><input type="checkbox" name="placement_abroad"> חו"ל</label>
                        </div>
                    </div>
                </div>

                <h3>כתובת מגורים</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="worker_street">רחוב</label>
                        <input type="text" id="worker_street" name="worker_street" maxlength="25">
                    </div>
                    <div class="form-group">
                        <label for="worker_house_number">מספר בית</label>
                        <input type="text" id="worker_house_number" name="worker_house_number" maxlength="5" class="small-input">
                    </div>
                    <div class="form-group">
                        <label for="worker_entrance">כניסה</label>
                        <input type="text" id="worker_entrance" name="worker_entrance" maxlength="3" class="small-input">
                    </div>
                    <div class="form-group">
                        <label for="worker_apartment">דירה</label>
                        <input type="text" id="worker_apartment" name="worker_apartment" maxlength="5" class="small-input">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="worker_city">ישוב</label>
                        <input type="text" id="worker_city" name="worker_city" maxlength="20">
                    </div>
                    <div class="form-group">
                        <label for="worker_day_off">יום חופשה</label>
                        <input type="text" id="worker_day_off" name="worker_day_off" maxlength="15">
                    </div>
                </div>
            </section>

            <!-- Page 1: Previous Visit Dates -->
            <section class="form-section">
                <h2>תאריכי ביקור אחרונים</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label for="pre_placement_date">תאריך טרום השמה</label>
                        <input type="date" id="pre_placement_date" name="pre_placement_date" class="date-input">
                    </div>
                    <div class="form-group">
                        <label for="pre_placement_social_worker">שם העו"ס</label>
                        <input type="text" id="pre_placement_social_worker" name="pre_placement_social_worker" maxlength="20">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="post_placement_date">תאריך לאחר השמה</label>
                        <input type="date" id="post_placement_date" name="post_placement_date" class="date-input">
                    </div>
                    <div class="form-group">
                        <label for="post_placement_social_worker">שם העו"ס</label>
                        <input type="text" id="post_placement_social_worker" name="post_placement_social_worker" maxlength="20">
                    </div>
                </div>
            </section>

            <!-- Page 2: Employer Assessment -->
            <section class="form-section">
                <h2>הערכת מצב המעסיק (הקשיש)</h2>

                <div class="form-group">
                    <label for="appearance_description">תאור הופעה חיצונית</label>
                    <textarea id="appearance_description" name="appearance_description" rows="2" placeholder="רגוע / חסר שקט / ניקיון / לבוש בהתאם לעונה / ריחות / הזנחה"></textarea>
                </div>

                <div class="form-group">
                    <label for="nutritional_status">תאור מצב תזונתי</label>
                    <textarea id="nutritional_status" name="nutritional_status" rows="2" placeholder="נראה בהתאם לגילו / רזה / שמן / וכו"></textarea>
                </div>

                <div class="form-group">
                    <label for="external_signs">תאור סממנים חיצוניים חריגים</label>
                    <textarea id="external_signs" name="external_signs" rows="2" placeholder="פיזיולוגי: סימנים כחולים, שטפי דם / מצב נפשי: מצב רוח ירוד, מתח, חרדה"></textarea>
                </div>

                <div class="form-group">
                    <label for="functional_status">תאור מצב תפקודי</label>
                    <textarea id="functional_status" name="functional_status" rows="2" placeholder="עצמאי / זקוק לעזרה במעברים / נעזר בזולת לפרקים / תלוי בזולת / סיעודי / מרותק למיטה"></textarea>
                </div>

                <div class="form-group">
                    <label for="health_status">תאור מצבו הבריאותי</label>
                    <textarea id="health_status" name="health_status" rows="2" placeholder="תקין / מחלות כרוניות / אירועים משמעותיים: מחלות, נפילות"></textarea>
                </div>

                <div class="form-row hospitalization-row">
                    <div class="form-group">
                        <label>האם אושפז לאחרונה</label>
                        <div class="checkbox-group inline">
                            <label><input type="checkbox" name="was_hospitalized_yes"> כן</label>
                            <label><input type="checkbox" name="was_hospitalized_no"> לא</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="hospitalization_where">איפה</label>
                        <input type="text" id="hospitalization_where" name="hospitalization_where">
                    </div>
                    <div class="form-group">
                        <label for="hospitalization_duration">משך זמן אשפוז</label>
                        <input type="text" id="hospitalization_duration" name="hospitalization_duration">
                    </div>
                </div>

                <div class="form-group">
                    <label for="cognitive_description">תאור קוגניטיבי</label>
                    <textarea id="cognitive_description" name="cognitive_description" rows="2" placeholder="תקשורת: לפי הבנה / הבעה / קוגניציה בהתנהגות: התנהגות חברתית, פתרון בעיות, זיכרון"></textarea>
                </div>

                <div class="form-group">
                    <label for="home_maintenance">התרשמות מתחזוקת הבית</label>
                    <textarea id="home_maintenance" name="home_maintenance" rows="2" placeholder="ניקיון / אוורור / חימום / שירותים / מטבח"></textarea>
                </div>

                <div class="form-group">
                    <label for="food_supply">קניות מזון עבור הקשיש ועבור העו"ז ואספקת ארוחות</label>
                    <textarea id="food_supply" name="food_supply" rows="2" placeholder="מי קונה / מתי / איך / התחשבות בצרכי העו"ז"></textarea>
                </div>

                <div class="form-group">
                    <label for="client_satisfaction">שביעות רצון הקשיש מהמטפל</label>
                    <input type="text" id="client_satisfaction" name="client_satisfaction" placeholder="גבוהה / מרוצה / אינו מרוצה / מבקש להחליף">
                </div>

                <div class="form-group">
                    <label for="family_satisfaction">שביעות רצון המשפחה מהמטפל</label>
                    <input type="text" id="family_satisfaction" name="family_satisfaction" placeholder="גבוהה / מרוצה / אינו מרוצה / מבקש להחליף">
                </div>

                <div class="form-group">
                    <label for="service_difficulties">האם יש קשיים או תלונות במתן השרות</label>
                    <textarea id="service_difficulties" name="service_difficulties" rows="2"></textarea>
                </div>

                <div class="form-group">
                    <label for="special_requests">בקשות מיוחדות של המעסיק</label>
                    <textarea id="special_requests" name="special_requests" rows="2"></textarea>
                </div>
            </section>

            <!-- Page 3: Worker Report -->
            <section class="form-section">
                <h2>דיווח על העובד הזר</h2>

                <div class="form-group">
                    <label for="worker_appearance">תאור הופעה חיצונית</label>
                    <textarea id="worker_appearance" name="worker_appearance" rows="2" placeholder="רגוע / חסר שקט / ניקיון / לבוש בהתאם לעונה / ריחות / הזנחה"></textarea>
                </div>

                <div class="form-group">
                    <label for="worker_training">האם העו"ז קיבל הדרכה טרם תחילת העבודה</label>
                    <textarea id="worker_training" name="worker_training" rows="2" placeholder="אודות צרכים מיוחדים של המעסיק, מחלות, מאכלים מיוחדים, הפעלת מוצרי חשמל"></textarea>
                </div>

                <div class="form-group">
                    <label for="worker_duties">מה הם תפקידי העו"ז</label>
                    <textarea id="worker_duties" name="worker_duties" rows="3" placeholder="ניקיון / כביסה / רחצה / בישול / החתלה / הלבשה / ליווי לטיפולים / השגחה בלילה / מתן תרופות / קניות וסידורים"></textarea>
                </div>

                <div class="form-group">
                    <label for="worker_satisfaction">האם העו"ז מרוצה</label>
                    <input type="text" id="worker_satisfaction" name="worker_satisfaction" placeholder="כן / לא / פרט">
                </div>

                <div class="form-group">
                    <label for="work_difficulties">האם נצפו קשיים בעבודה עם הקשיש</label>
                    <textarea id="work_difficulties" name="work_difficulties" rows="2" placeholder="כן / לא / פרט - למשל: האם מטפל בבני משפחה נוספים / עומס עבודה"></textarea>
                </div>

                <div class="form-group">
                    <label for="duties_match_satisfaction">האם יש הלימה בין עבודות העו"ז לשביעות רצונו של העובד</label>
                    <input type="text" id="duties_match_satisfaction" name="duties_match_satisfaction">
                </div>

                <div class="form-group">
                    <label for="worker_has_friends">האם לעו"ז יש חברים או מכרים באזור</label>
                    <input type="text" id="worker_has_friends" name="worker_has_friends">
                </div>

                <h3>תנאי העסקת העו"ז</h3>

                <div class="form-row">
                    <div class="form-group">
                        <label>החוזה נמצא בידי</label>
                        <div class="checkbox-group inline">
                            <label><input type="checkbox" name="contract_employer"> המעסיק</label>
                            <label><input type="checkbox" name="contract_worker"> העובד</label>
                            <label><input type="checkbox" name="contract_other"> אחר</label>
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>החוזה תורגם לשפת העו"ז</label>
                        <div class="checkbox-group inline">
                            <label><input type="checkbox" name="contract_translated_yes"> כן</label>
                            <label><input type="checkbox" name="contract_translated_no"> לא</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="insurance_from">ביטוח רפואי תקף מ-</label>
                        <input type="date" id="insurance_from" name="insurance_from" class="date-input">
                    </div>
                    <div class="form-group">
                        <label for="insurance_to">עד</label>
                        <input type="date" id="insurance_to" name="insurance_to" class="date-input">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="insurance_company">שם החברה המבטחת</label>
                        <input type="text" id="insurance_company" name="insurance_company">
                    </div>
                    <div class="form-group">
                        <label for="last_insurance_payment">תשלום אחרון בגין ביטוח לאומי</label>
                        <input type="date" id="last_insurance_payment" name="last_insurance_payment" class="date-input">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="monthly_salary">שכר עבודה קבוע</label>
                        <input type="text" id="monthly_salary" name="monthly_salary">
                    </div>
                    <div class="form-group">
                        <label for="total_payment">סה"כ לתשלום</label>
                        <input type="text" id="total_payment" name="total_payment">
                    </div>
                    <div class="form-group">
                        <label for="payment_date">מועד התשלום</label>
                        <input type="text" id="payment_date" name="payment_date">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>אופן התשלום</label>
                        <div class="checkbox-group inline">
                            <label><input type="checkbox" name="payment_check"> שיק</label>
                            <label><input type="checkbox" name="payment_bank"> הפקדה לחשבון</label>
                            <label><input type="checkbox" name="payment_cash"> מזומן</label>
                            <label><input type="checkbox" name="payment_other"> אחר</label>
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="weekly_day_off">יום החופש השבועי</label>
                        <input type="text" id="weekly_day_off" name="weekly_day_off">
                    </div>
                    <div class="form-group wide">
                        <label for="accommodation">מגורים הולמים לעובד הזר</label>
                        <input type="text" id="accommodation" name="accommodation" placeholder="חדר שינה / כלי מיטה / ארון בגדים / חימום / אינטרנט / טלוויזיה">
                    </div>
                </div>

                <div class="form-group">
                    <label for="notes">הערות</label>
                    <textarea id="notes" name="notes" rows="3"></textarea>
                </div>
            </section>

            <!-- Page 4: Treatment Plan -->
            <section class="form-section">
                <h2>תכנית טיפול</h2>

                <div class="form-group">
                    <label for="treatment_essence">מהות הטיפול</label>
                    <textarea id="treatment_essence" name="treatment_essence" rows="3" placeholder="על העובד הסוציאלי לשקול תכנית טיפולית תואמת לאור הנתונים אשר נצפו במהלך המפגש"></textarea>
                </div>

                <div class="form-group">
                    <label>סוג הטיפול</label>
                    <div class="checkbox-group">
                        <label><input type="checkbox" name="treatment_employer_issues"> טיפול בבעיות של המעסיק</label>
                        <label><input type="checkbox" name="treatment_worker_issues"> טיפול בבעיות של העובד הזר</label>
                        <label><input type="checkbox" name="treatment_mediation"> גישור</label>
                        <label><input type="checkbox" name="treatment_followup"> מעקב</label>
                        <label><input type="checkbox" name="treatment_referral"> תיווך והפניה לשירותים</label>
                        <label><input type="checkbox" name="treatment_family_report"> דיווח לבן משפחה</label>
                    </div>
                </div>

                <div class="form-group">
                    <label for="summary_employer">סיכום והתרשמות - בנוגע למעסיק</label>
                    <textarea id="summary_employer" name="summary_employer" rows="3"></textarea>
                </div>

                <div class="form-group">
                    <label for="summary_caregiver">סיכום והתרשמות - בנוגע למטפל</label>
                    <textarea id="summary_caregiver" name="summary_caregiver" rows="3"></textarea>
                </div>

                <div class="form-group">
                    <label>נוכחים בביקור</label>
                    <div class="checkbox-group inline">
                        <label><input type="checkbox" name="attendee_employer"> מעסיק</label>
                        <label><input type="checkbox" name="attendee_family"> בן משפחה</label>
                        <label><input type="checkbox" name="attendee_worker"> עובד זר</label>
                        <label><input type="checkbox" name="attendee_office_rep"> נציג הלשכה הפרטית</label>
                        <label><input type="checkbox" name="attendee_other"> אחר</label>
                    </div>
                </div>

                <h3>חתימות</h3>

                <div class="form-row">
                    <div class="form-group">
                        <label for="signer_id">ת.ז. החותם</label>
                        <input type="text" id="signer_id" name="signer_id" maxlength="9">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="social_worker_name_signature">שם העובד הסוציאלי / בעל תפקיד</label>
                        <input type="text" id="social_worker_name_signature" name="social_worker_name_signature">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group signature-group">
                        <label>חתימה</label>
                        <div class="signature-pad-container">
                            <canvas id="signaturePad" class="signature-pad"></canvas>
                            <div class="signature-pad-actions">
                                <button type="button" id="clearSignature" class="btn-clear-signature">נקה חתימה</button>
                            </div>
                        </div>
                        <p class="signature-instructions">צייר את החתימה בעזרת העכבר או באצבע במסך מגע</p>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="responsible_worker_name">שם העובד הסוציאלי האחראי</label>
                        <input type="text" id="responsible_worker_name" name="responsible_worker_name">
                    </div>
                    <div class="form-group">
                        <label for="responsible_worker_id">ת.ז.</label>
                        <input type="text" id="responsible_worker_id" name="responsible_worker_id" maxlength="9">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="signature_date">תאריך</label>
                        <input type="date" id="signature_date" name="signature_date" class="date-input">
                    </div>
                </div>
            </section>

            <div class="form-actions">
                <button type="submit" class="btn-primary">הפק PDF</button>
                <button type="reset" class="btn-secondary">נקה טופס</button>
            </div>
        </form>

        <div id="loading" class="loading" style="display: none;">
            <div class="spinner"></div>
            <p>מייצר PDF...</p>
        </div>

        <div id="error-message" class="error-message" style="display: none;"></div>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
